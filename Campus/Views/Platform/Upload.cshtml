@model PlatformUploadViewModel
@{
	ViewBag.Title = "投稿";
}

@section style{
	<link rel="stylesheet" href="~/css/sendpost/post.css" asp-append-version="true">
	<link href="~/lib/summernote-0.8.12/dist/summernote.css" rel="stylesheet" asp-append-version="true">
	<link href="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" asp-append-version="true">
	<style>
		* {
			user-select: none
		}
	</style>
}
	<div id="post-body">
		<div class="post-head">
			<div class="post-logo"><img src="~/img/sendpost/logo.png" style="height: 100%;width:75%;opacity: 0.8;"></div>
			<div class="post-tx">
				<span>
					<a asp-action="" asp-controller="Space">
						<img asp-append-version src="@Model.HeadPortrait" style="width: 100%;height: 100%;border-radius: 50%;">
					</a>
				</span>
			</div>
		</div>
		<div class="post-connect">
			<div class="post-ul">
				<ul class="pul">
					<li id="lia" style="background-color: rgb(161, 221, 234);color: black;">投稿</li>
					<li id="WorksManage">稿件管理</li>
					<li id="Guit">稿件指南</li>
				</ul>
			</div>
			<div class="post-bit" id="content">
				<form method="post" style="height:100%;width: 100%;">
					<input asp-for="HeadPortrait" type="hidden" />
					<div class="panel panel-default" style="height:100%;width: 100%;">
						<div class="panel-body">
							<div class="form-group">
								<label asp-for="Title"></label>
								<input asp-for="Title" class="form-control">
								<span asp-validation-for="Title"></span>
							</div>
							<label asp-for="Content"></label>
							<textarea asp-for="Content" id="summernote"></textarea>
							<span asp-validation-for="Content"></span>
							<div class="post-type">
								<p style="font-size: 10px;">请选择话题</p>
								<ul class="tul">
									@for (int i = 0; i < Model.SpecialColumns!.Count; i++)
								{
									<li>
										<input asp-for="SpecialColumnId" type="radio" checked="@(i==0)" value="@Model.SpecialColumns[i].SpecialColumnId" />
										@Model.SpecialColumns[i].SpecialColumnValue
									</li>
								}

							</ul>
						</div>
						<div class="form-group text-right" style="margin-top:20px">
							@*<button type="button" class="btn btn-default">保存草稿</button>*@
							<input type="submit" value="发布"
								   class="btn btn-primary" style="background-color: #6699CC;" />
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

@section script{
	<script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>
	<script src="~/lib/summernote-0.8.12/dist/summernote.js"></script>
	<script src="~/lib/summernote-0.8.12/dist/lang/summernote-zh-CN.js"></script>
	<script>
		$(function() {
			$('#summernote').summernote({
				height: 215,                 // set editor height
				minHeight: 215,             // set minimum height of editor
				maxHeight: 215,              // set maximum height of editor
				focus: true,                 // set focus to editable area after initializing summernote
				lang: 'zh-CN',               // default: 'en-US'
				callbacks: {
					onImageUpload: function(files) {
						sendFile(files[0]);
					}
				}
			});
			$('#lia').click(function() {
				window.location = '/Platform/Upload';
			})
			$('#WorksManage').click(function() {
				$.ajax({
					url: "/Platform/Manage",
					method: "Get",
					success: function(res) {
						$("#content").html(res);
					}
				})
			})
		});
		function sendFile(file) {
			data = new FormData();
			data.append("file", file);
			$.ajax({
				data: data,
				type: "POST",
				url: "/platform/uploadimage",
				cache: false,
				contentType: false,
				processData: false,
				success: function(url) {
					console.log(url)
					$('#summernote').summernote('insertImage', url, function($image) {
						$image.attr('src', url);
					});
				}
			});
		}
		$("#WorksManage").click(function() {
			$(this).css("background-color", "rgb(161, 221, 234)")
			$(this).css("color", "black")
			$("#lia").css("background-color", "#666699")
			$("#lia").css("color", "white")
			$("#Guit").css("background-color", "#666699")
			$("#Guit").css("color", "white")
			
		})
		$('#Guit').click(function() {
			$(this).css("background-color", "rgb(161, 221, 234)")
			$(this).css("color", "black")
			$("#lia").css("background-color", "#666699")
			$("#lia").css("color", "white")
			$("#WorksManage").css("background-color", "#666699")
			$("#WorksManage").css("color", "white")
			$.ajax({
				url: "/Platform/Submission_Guide",
				method: "Get",
				success: function(res) {
					$("#content").html(res);
				}
			})
		})
	</script>
	}
